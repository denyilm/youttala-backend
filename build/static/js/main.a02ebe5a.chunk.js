(this["webpackJsonpyouttala-frontend"]=this["webpackJsonpyouttala-frontend"]||[]).push([[0],{30:function(e,t,n){},62:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n(1),a=n(20),s=n.n(a),i=(n(30),n(3)),o=n.n(i),u=n(7),l=n(4),d=n(8),b=n.n(d),j="/api/subtitles",h={getAll:function(){return b.a.get(j).then((function(e){return e.data}))},reportBug:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(j,"/").concat(t.videoId),e.next=3,b.a.put(n,t);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),deleteBuggyLines:function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="".concat(j,"/").concat(t.id),e.next=3,b.a.put(n,t);case 3:return r=e.sent,e.abrupt("return",r.data);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()};var f=function(e,t){var n=/[.,"'?!;:]*/,r=new RegExp(/^/.source+n.source+e+n.source+/$/.source,"i"),c=[];return t.forEach((function(e){e.split(" ").forEach((function(t){r.test(t)&&c.push(e)}))})),0!==c.length};function x(e,t){for(var n,r,c,a="",s="",i="",o=e;o>0;o--)if(t[o].includes("--\x3e")){n=t[o],a=t[o].substring(0,2),s=t[o].substring(3,5),i=t[o].substring(6,8),r=o;break}return{timeStamp:n,time:(c=[a,s,i],3600*parseInt(c[0])+60*parseInt(c[1])+parseInt(c[2])),firstTimeIndex:r}}function p(e,t){for(var n,r,c=e+1;c<t.length-1;c++)if(t[c].includes("--\x3e")){n=t[c],r=c;break}return{nextTimeStamp:n,secondTimeIndex:r}}var O=function(e,t,n){var r=/[.,"'?!;:]*/,c=new RegExp(/^/.source+r.source+e+r.source+/$/.source,"i"),a=[];return t.forEach((function(e){for(var t=n.filter((function(t){return t.videoId===e}))[0].text,r=t.length,s=function(n){var r=void 0,s=void 0,i=void 0,o="";t[n].split(" ").forEach((function(u){c.test(u)&&(r=x(n,t).time,s=x(n,t).timeStamp,i=x(n,t).firstTimeIndex,o=function(e,t){return"https://www.youtube.com/embed/".concat(e,"?start=").concat(t,"&autoplay=1&cc_load_policy=1&cc_lang_pref=sv")}(e,r),a.push({youtubeLink:o,id:e,time:r,timeStamp:s,firstTimeIndex:i,nextTimeStamp:p(i,t).nextTimeStamp,secondTimeIndex:p(i,t).secondTimeIndex,lineIndex:n,wholeText:t,lineText:t[n]}))}))},i=0;i<r-1;i++)s(i)})),function(e){for(var t=[],n=[],r=e.length,c=0;c<r;){var a=Math.floor(Math.random()*r);-1===n.indexOf(a)&&(c++,n.push(a),t.push(e[a]))}return t}(a)};var m=function(e,t,n){for(var r,c,a=t+1;a<n.length-1;a++)if(n[a].includes("--\x3e")){r=n[a],c=a;break}var s,i=r.split(" --\x3e "),o=i[0].substring(0,2),u=i[0].substring(3,5),l=i[0].substring(6,8);return{timeDifference:(s=[o,u,l],3600*parseInt(s[0])+60*parseInt(s[1])+parseInt(s[2]))-e,text:function(e,t,n){return e.slice(t+1,n).reduce((function(e,t){return e+t+"\n"}),"").split("\n").slice(0,-1).join("\n")}(n,t,c),nextTimeStamp:r}},v=function(){return Object(r.jsxs)("div",{className:"main-header",children:[Object(r.jsx)("a",{href:"/",className:"brand-logo",children:Object(r.jsx)("div",{className:"brand-logo-name",children:"youttala"})}),Object(r.jsx)("div",{className:"main-nav",children:Object(r.jsxs)("ul",{children:[Object(r.jsx)("li",{children:Object(r.jsx)("a",{href:"#",children:"om"})}),Object(r.jsx)("li",{children:Object(r.jsx)("a",{href:"#",children:"kontakt"})}),Object(r.jsx)("li",{children:Object(r.jsx)("a",{href:"#",children:"nyheter"})})]})})]})},g=function(e){return Object(r.jsx)("div",{children:Object(r.jsxs)("form",{className:"form",onSubmit:e.handleSubmit,children:[Object(r.jsx)("input",{autoFocus:!0,className:"searchbar",value:e.query,type:"text",onChange:e.handleQueryChange}),Object(r.jsx)("button",{className:"search-button",type:"submit",children:"Search"})]})})},y=n(21),I=n(5),w=function(e){var t={display:e.showStats?"":"none"},n={display:e.showStats?"none":""};return Object(r.jsxs)("div",{className:"player",children:[Object(r.jsx)("div",{className:"video",children:Object(r.jsx)(y.a,{videoId:e.videoId,opts:e.opts,onPlay:e.onPlay})}),Object(r.jsxs)("div",{className:"player-bar",children:[Object(r.jsx)("div",{className:"empty"}),Object(r.jsxs)("div",{className:"button-set",children:[Object(r.jsx)("div",{children:Object(r.jsx)("button",{className:"button",title:"Previous video",id:"back-button",onClick:e.handleBack,children:Object(r.jsx)(I.a,{size:23})})}),Object(r.jsx)("div",{children:Object(r.jsx)("button",{className:"button",id:"restart-button",title:"replay",onClick:e.handleK\u00f6rOm,children:Object(r.jsx)(I.f,{size:23})})}),Object(r.jsx)("div",{children:Object(r.jsx)("button",{className:"button",id:"next-button",title:"next video",onClick:e.handleNext,children:Object(r.jsx)(I.e,{size:23})})})]}),Object(r.jsxs)("div",{className:"extras",children:[Object(r.jsxs)("span",{style:t,children:[" ",e.videoIndex," av ",e.length]}),Object(r.jsx)("span",{style:n}),Object(r.jsx)("button",{className:"button",title:"report a bug",onClick:e.handleBug,children:Object(r.jsx)(I.c,{size:13})})]})]})]})},S=function(e){var t=e.shownSubtitles,n=e.shownSubtitlesArr,c=e.showSubtitle,a=e.handleShow,s=e.handleHide,i=e.query,o={display:c?"none":""},u={display:c?"":"none"},l=/[.,"'?!;:]*/,d=new RegExp(/^/.source+l.source+i+l.source+/$/.source,"i");return Object(r.jsx)("div",{children:null===t?Object(r.jsx)("div",{className:"first-subtitle",children:Object(r.jsx)("div",{className:"yarrak",children:"You may find your search result here!"})}):Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{className:"subtitle",style:u,children:[Object(r.jsxs)("div",{className:"subtitle-buttons",children:[Object(r.jsx)("button",{style:{display:"none"},className:"button",children:Object(r.jsx)(I.b,{size:13})}),Object(r.jsx)("button",{className:"button",title:"hide the search result",onClick:s,children:Object(r.jsx)(I.d,{size:13})})]}),Object(r.jsx)("div",{className:"subtitle-subtitle",children:Object(r.jsx)("p",{className:"paragraph",children:n.map((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Object(r.jsxs)("span",{style:{color:d.test(e)?"red":"black"},children:[e,"\xa0"]},e+t+1)}))})})]}),Object(r.jsxs)("div",{className:"hidden-subtitle",style:o,children:[Object(r.jsx)("div",{id:"three-dots",children:Object(r.jsx)("span",{})}),Object(r.jsx)("div",{id:"show-button-bar",children:Object(r.jsx)("button",{className:"button",title:"show the search result",onClick:a,children:Object(r.jsx)(I.d,{size:13})})})]})]})})},k=function(){return Object(r.jsx)("div",{className:"main-footer",children:Object(r.jsx)("nav",{className:"footer-nav",children:Object(r.jsxs)("ul",{children:[Object(r.jsx)("li",{children:Object(r.jsx)("a",{href:"#",children:"license"})}),Object(r.jsx)("li",{children:Object(r.jsx)("a",{href:"#",children:"e-mail"})})]})})})},N=function(e){return Object(r.jsxs)("div",{style:{display:"none",border:"solid",borderWidth:1},children:["admin bar, correct buggy lines!",Object(r.jsx)("br",{}),"OBS! dont forget to enable the correct put route and disable the other one in backend!",Object(r.jsx)("br",{}),"Search by videoId, once found search by bugId, once found remove it",Object(r.jsxs)("form",{onSubmit:e.searchVideoById,children:["Query videoId:",Object(r.jsx)("input",{value:e.queryVideoId,type:"text",onChange:e.handleQueryVideoIdChange}),Object(r.jsx)("button",{type:"submit",children:"search by id"})]}),Object(r.jsx)("span",{children:e.adminMessage1}),Object(r.jsx)("br",{}),Object(r.jsxs)("form",{onSubmit:e.searchBugById,children:["Query bugId:",Object(r.jsx)("input",{value:e.queryBugId,type:"text",onChange:e.handleQueryBugIdChange}),Object(r.jsx)("button",{type:"submit",children:"search bug"})]}),Object(r.jsx)("span",{children:e.adminMessage2}),Object(r.jsx)("br",{}),Object(r.jsx)("button",{onClick:e.handleCorrect,children:"remove the buggy part"}),Object(r.jsx)("br",{}),Object(r.jsx)("span",{children:e.adminMessage3})]})},T=(n(63),function(){var e=Object(c.useState)([]),t=Object(l.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(""),i=Object(l.a)(s,2),d=i[0],b=i[1],j=Object(c.useState)([]),x=Object(l.a)(j,2),p=x[0],y=x[1],I=Object(c.useState)(0),T=Object(l.a)(I,2),B=T[0],C=T[1],E=Object(c.useState)("5bfx6BNufdE"),L=Object(l.a)(E,2),D=L[0],_=L[1],q=Object(c.useState)([]),z=Object(l.a)(q,2),M=z[0],Q=z[1],V=Object(c.useState)(null),A=Object(l.a)(V,2),P=A[0],W=A[1],R=Object(c.useState)([]),$=Object(l.a)(R,2),H=$[0],J=$[1],K=Object(c.useState)(!1),F=Object(l.a)(K,2),Y=F[0],G=F[1],U=Object(c.useState)(!1),X=Object(l.a)(U,2),Z=X[0],ee=X[1],te=Object(c.useState)(0),ne=Object(l.a)(te,2),re=ne[0],ce=ne[1],ae=Object(c.useState)("640"),se=Object(l.a)(ae,2),ie=se[0],oe=se[1],ue=Object(c.useState)("360"),le=Object(l.a)(ue,2),de=le[0],be=(le[1],Object(c.useState)(0)),je=Object(l.a)(be,2),he=je[0],fe=je[1],xe=Object(c.useState)(0),pe=Object(l.a)(xe,2),Oe=pe[0],me=pe[1],ve=Object(c.useState)(""),ge=Object(l.a)(ve,2),ye=ge[0],Ie=ge[1],we=Object(c.useState)(""),Se=Object(l.a)(we,2),ke=Se[0],Ne=Se[1],Te=Object(c.useState)(""),Be=Object(l.a)(Te,2),Ce=Be[0],Ee=Be[1],Le=Object(c.useState)(null),De=Object(l.a)(Le,2),_e=De[0],qe=De[1],ze=Object(c.useState)(""),Me=Object(l.a)(ze,2),Qe=Me[0],Ve=Me[1],Ae=Object(c.useState)(""),Pe=Object(l.a)(Ae,2),We=Pe[0],Re=Pe[1];Object(c.useEffect)((function(){h.getAll().then((function(e){a(e)}))}),[]);var $e=function(){var e=Object(u.a)(o.a.mark((function e(t){var r,c,a,s,i,u,l,b;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),console.log(d),r=[],c=[];try{console.log("inside try",d),n.forEach((function(e){f(d,e.text)&&(console.log("inside subtitles"),console.log(!0),console.log(e.id),c.push(e.videoId),console.log(c))})),r=O(d,c,n),y(r),C(0),a=r[0].id,_(a),s=r[0].time,ce(s),a===D&&s===re&&oe("640"===ie?"640.1":"640"),i=r[0].wholeText,Q(i),u=r[0].firstTimeIndex,me(u),fe(1),G(!1),ee(!0)}catch(o){0===c.length&&(_("5bfx6BNufdE"),Q([]),me(0),ce(0),fe(0),ee(!1),y([]),l="nothing found for ".concat(d,", try 'skillnad'"),W(l),b=l.split(/[\s\n]+/),J(b),G(!0))}case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();window.addEventListener("resize",(function(e){e.preventDefault(),window.innerWidth<415?oe("310"):window.innerWidth<668?oe("400"):window.innerWidth>668&&oe("640")}));var He={height:de,width:ie,playerVars:{cc_lang_pref:"sv",autoplay:he,start:re,cc_load_policy:1,enablejsapi:1}},Je=function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r,c,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),B>=1&&(C(B-1),n=p[B-1].id,_(n),r=p[B-1].time,ce(r),n===D&&r===re&&oe("640"===ie?"640.1":"640"),c=p[B-1].wholeText,Q(c),a=p[B-1].firstTimeIndex,me(a),G(!1));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ke=function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),G(!0),oe("640"===ie?"640.1":"640");case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Fe=function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r,c,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),B<p.length-1&&(C(B+1),n=p[B+1].id,_(n),r=p[B+1].time,ce(r),n===D&&r===re&&oe("640"===ie?"640.1":"640"),c=p[B+1].wholeText,Q(c),a=p[B+1].firstTimeIndex,me(a),G(!1));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ye=function(){var e=Object(u.a)(o.a.mark((function e(t){var n,r,c,a,s,i,u,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(t.videoId),e.prev=1,n=t.buggyLines,r=p[B],c=r.timeStamp,a=c.substring(0,2),s=c.substring(3,5),i=c.substring(6,8),u=c.substring(9,12),l="".concat(r.id,"_").concat(a).concat(s).concat(i).concat(u),n.find((function(e){return e.bugId===l}))){e.next=17;break}return n.push({bugId:l,buggyText:r.lineText,lineIndex:r.lineIndex,time:r.time,timeStamp:r.timeStamp,firstTimeIndex:r.firstTimeIndex,nextTimeStamp:r.nextTimeStamp,secondTimeIndex:r.secondTimeIndex,link:r.youtubeLink}),e.next=14,h.reportBug({videoId:t.videoId,buggyLines:n});case 14:e.sent,e.next=18;break;case 17:console.log("already reported");case 18:console.log("handleBug worked"),e.next=25;break;case 21:e.prev=21,e.t0=e.catch(1),console.log(e.t0),console.log("handleBug failed");case 25:case"end":return e.stop()}}),e,null,[[1,21]])})));return function(t){return e.apply(this,arguments)}}(),Ge=function(){var e=Object(u.a)(o.a.mark((function e(t){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault();try{Q([]),me(0),ce(0),fe(0),ee(!1),y([]),n.find((function(e){return e.videoId===ye}))?(_(ye),Ee("".concat(ye," found")),qe(n.find((function(e){return e.videoId===ye})))):(_("5bfx6BNufdE"),Ee("This subtitle is not in the db"),Ne(""),Ve(""))}catch(r){console.log(r),Ee("There was an error, check the console"),Q([]),me(0),ce(0),fe(0),ee(!1),y([]),_("5bfx6BNufdE")}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ue=function(){var e=Object(u.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault();try{_e.buggyLines.find((function(e){return e.bugId===ke}))?(Ve("".concat(ke," found")),Ne(ke),n=_e.buggyLines.find((function(e){return e.bugId===ke})),ce(n.time),fe(1),W(!1)):Ve("".concat(ke," not found"))}catch(r){console.log(r),Ve("There was an error, see the console, ".concat(ke," not found"))}case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Xe=function(){var e=Object(u.a)(o.a.mark((function e(t,n){var r,c,a,s,i,u,l;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.buggyLines.find((function(e){return e.bugId===n})),console.log(r),!window.confirm("Do you really want to remove the part from ".concat(r.timeStamp," to ").concat(r.nextTimeStamp,"?"))){e.next=26;break}return e.prev=4,c=r.firstTimeIndex,a=r.secondTimeIndex,s=a-c,i=t.buggyLines.slice(),console.log(i),u=i.filter((function(e){return e.bugId!==n})),console.log(u),(l=t.text).splice(c,s),e.next=16,h.deleteBuggyLines({id:t.id,buggyLines:u,text:l});case 16:e.sent,Re("".concat(n," corrected")),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(4),console.log(e.t0),Re("Correction failed, see the conssole");case 24:e.next=27;break;case 26:Re("Correction cancelled");case 27:case"end":return e.stop()}}),e,null,[[4,20]])})));return function(t,n){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{children:[Object(r.jsx)(v,{}),Object(r.jsx)(N,{queryVideoId:ye,handleQueryVideoIdChange:function(e){return Ie(e.target.value)},searchVideoById:Ge,adminMessage1:Ce,queryBugId:ke,handleQueryBugIdChange:function(e){return Ne(e.target.value)},searchBugById:Ue,adminMessage2:Qe,handleCorrect:function(){return Xe(_e,ke)},adminMessage3:We}),Object(r.jsxs)("div",{className:"container",children:[Object(r.jsx)(g,{query:d,handleQueryChange:function(e){return b(e.target.value)},handleSubmit:$e}),Object(r.jsx)("div",{className:"player-all",children:Object(r.jsx)(w,{videoId:D,opts:He,handleBack:Je,"handleK\xf6rOm":Ke,handleNext:Fe,onPlay:function(e){if(M.length>0){var t=m(re,Oe,M);W(t.text);var n=t.text.split(/[\s\n]+/);J(n),G(!0);var r=1e3*t.timeDifference;setTimeout((function(){G(!1)}),r)}},showStats:Z,videoIndex:B+1,length:p.length,handleBug:function(){return Ye(n.find((function(e){return e.videoId===D})))}})}),Object(r.jsx)(S,{showSubtitle:Y,shownSubtitles:P,shownSubtitlesArr:H,handleShow:function(){return G(!0)},handleHide:function(){return G(!1)},query:d})]}),Object(r.jsx)(k,{})]})});s.a.render(Object(r.jsx)(T,{}),document.getElementById("root"))}},[[62,1,2]]]);
//# sourceMappingURL=main.a02ebe5a.chunk.js.map